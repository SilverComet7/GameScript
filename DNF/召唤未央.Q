[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=f86eb0f4-b915-4657-b2fa-b783e7094ad5
Description=召唤未央
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=2
QUI=
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
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


[Script]
Call 大漠注册()
Function 大漠注册()
    need_ver = "3.1233"
    Set ws = createobject("Wscript.Shell")
    ws.run "regsvr32 atl.dll /s"
    Set ws = nothing
    PutAttachment "C:\Users\ChrisWang\Desktop\大漠插件3.1233", "*.*"
    PutAttachment ".\Plugin", "RegDll.dll"
    Call Plugin.RegDll.Reg("C:\Users\ChrisWang\Desktop\大漠插件3.1233\dm.dll")
    Set dm = createobject("dm.dmsoft")
    ver = dm.Ver()
    If ver <> need_ver Then
        Set dm = nothing
        Set ws = createobject("Wscript.Shell")
        ws.run "regsvr32 C:\Users\ChrisWang\Desktop\大漠插件3.1233\dm.dll /s"
        Set ws = nothing
        Delay 1200
        Set dm = createobject("dm.dmsoft")
        ver = dm.Ver()
        If ver <> need_ver Then
            MessageBox "插件版本错误,当前使用的版本是:" & ver & ",插件所在目录是:" & dm.GetBasePath()
            MessageBox "请关闭程序,重新打开本程序再尝试"
            EndScript
        End If
    Else
        TracePrint ver
        TracePrint "注册成功！"
    End If
End Function
Sub OnScriptExit()
    dm_ret = dm.UnBindWindow() 
End Sub
Function 一秒内随机延迟()
    Randomize
    Delay Rnd*700+400
End Function
Function dm随机点击(x, y, w,h,way)
    dm.MoveToEx x,y,w,h
    Call 一秒内随机延迟()
    If way = "L" Then
        dm.LeftClick
    Else
        dm.RightClick 
    End If
    Call 一秒内随机延迟()
End Function
Function dm找单个图(picPath)
    pos = dm.FindPicE(0,0,800,600,picPath,"000000",0.5,0)
    pos = split(pos,"|")
    If int(pos(1)) > 0 Then 
        x = pos(1)
        y = pos(2)
        //        TracePrint  picPath + "位置： x:"+x+"y:"+y
    End If
    dm找单个图 = pos
End Function
Function dm小地图找图(picPath)
    pos = dm.FindPicE(680,20,795,100,picPath,"000000",0.5,0)
    pos = split(pos,"|")
    If int(pos(1)) > 0 Then 
        x = pos(1)
        y = pos(2)
        //        TracePrint  picPath + "位置： x:"+x+"y:"+y
    End If
    dm小地图找图 = pos
End Function
Function 按键找字(word)
    iCoord = Plugin.Pic.FindWordShape(0, 0, 800, 600, word, "宋体", 9, 0, 0.5)
    XY = Split(iCoord, "|")
    If XY(0) >= 0 Then
        TracePrint  word+"位置x"+XY(0) +"y:"+XY(1)
    End If
    按键找字 = XY
End Function
dm_soft  = dm.SetDict(0,"C:\Users\ChrisWang\Desktop\大漠插件3.1233\dm_soft.txt")
st9 = dm.SetDict(1,"C:\Users\ChrisWang\Desktop\大漠插件3.1233\宋体9号.txt")
ywsz9 = dm.SetDict(2,"C:\Users\ChrisWang\Desktop\大漠插件3.1233\英文+数字.txt")
hwnd = dm.FindWindow("地下城与勇士", "地下城与勇士")
dm.MoveWindow hwnd,0,0
dm_ret = dm.BindWindow(hwnd, "normal", "normal", "dx", 0)

// 公共函数End
Function move(action)
    If action = "up" Then 
        dm.KeyUpChar "left"
        dm.KeyUpChar "right"
        dm.KeyUpChar "down"
        dm.KeyDownChar "up"
    ElseIf action = "down" Then
        dm.KeyUpChar "left"
        dm.KeyUpChar "right"
        dm.KeyUpChar "up"
        dm.KeyDownChar "down"
    ElseIf action = "left" Then
        dm.KeyUpChar "up"
        dm.KeyUpChar "down"
        dm.KeyUpChar "right"
        dm.KeyDownChar "left"
    ElseIf action = "right" Then
        dm.KeyUpChar "up"
        dm.KeyUpChar "down"
        dm.KeyUpChar "left"
        dm.KeyDownChar "right"
    ElseIf action = "leftUp" Then
        dm.KeyUpChar "down"
        dm.KeyUpChar "right"
        dm.KeyDownChar "left"
        dm.KeyDownChar "up"
    ElseIf action = "leftDown" Then
        dm.KeyUpChar "right"
        dm.KeyUpChar "up"
        dm.KeyDownChar "left"
        dm.KeyDownChar "down"
    ElseIf action = "rightUp" Then
        dm.KeyUpChar "left"
        dm.KeyUpChar "down"
        dm.KeyDownChar "right"
        Delay 500
        dm.KeyDownChar "up"
    ElseIf action = "rightDown" Then
        dm.KeyUpChar "left"
        dm.KeyUpChar "up"
        dm.KeyDownChar "right"
        Delay 500
        dm.KeyDownChar "down"
    End If
End Function
Function releseMove()
    dm.KeyUpChar "left"
    dm.KeyUpChar "right"
    dm.KeyUpChar "up"
    dm.KeyUpChar "down"
End Function
Function 人物往目标移动(人物与目标X距离,人物与目标Y距离,触发距离X,触发距离Y)
    If Abs(人物与目标X距离) > 触发距离X And Abs(人物与目标Y距离) > 触发距离Y  Then 
        If 人物与目标X距离 > 0 And  人物与目标Y距离 > 0  Then 
            Call move("leftUp")
        ElseIf  人物与目标X距离 > 0 And  人物与目标Y距离 < 0 
            Call move("leftDown")
        ElseIf  人物与目标X距离 < 0 And  人物与目标Y距离 > 0 
            Call move("rightUp")
        ElseIf  人物与目标X距离 < 0 And  人物与目标Y距离 < 0 
            Call move("rightDown")
        End If
    ElseIf Abs(人物与目标X距离) < 触发距离X And Abs(人物与目标Y距离) > 触发距离Y Then 
        If 人物与目标Y距离 > 0 Then 
            Call move("up")
        Else 
            Call move("down")
        End If
    ElseIf Abs(人物与目标X距离) > 触发距离X And Abs(人物与目标Y距离) < 触发距离Y Then 
        If 人物与目标X距离 > 0 Then 
            Call move("left")
        Else 
            Call move("right")
        End If   
    End If
End Function
Function 人物保持中线向右移动(人物腰的位置)
    If 人物腰的位置 > 380 Then // 屏幕中线
        TracePrint "右上移动"
        Call move("rightUp")
    Else 
        TracePrint "右下移动"
        Call move("rightDown")    
    End If
End Function
Function relaseSkill(keyChar)
    dm.KeyPressChar keyChar
    Call 一秒内随机延迟()
End Function
Function 随机左右()
    Randomize
    If Rnd > 0.5 Then 
        Call move("right")
    Else 
        Call move("left")	
    End If
End Function
Function 司南界面(修理)
    drsn = dm找单个图("C:\Users\ChrisWang\Desktop\dnf-img\1drsn.bmp|C:\Users\ChrisWang\Desktop\dnf-img\2drsn.bmp|C:\Users\ChrisWang\Desktop\dnf-img\3drsn.bmp|C:\Users\ChrisWang\Desktop\dnf-img\4drsn.bmp|C:\Users\ChrisWang\Desktop\dnf-img\5drsn.bmp")
    司南界面 = int(drsn(1))
    If int(drsn(1)) > 0 Then
        dm.KeyPressChar "~"
        Delay 1000
        Call relaseSkill ("x")
        Call relaseSkill("x")
        If 修理 > 0 Then 
            dm.KeyPressChar "s"
            Call 一秒内随机延迟()
            dm.KeyPressChar "space"
        End If
        Call dm随机点击(drsn(1),drsn(2),5,5,"R")
        Call dm随机点击(160, 545, 10, 10, "L")// 进场按钮
        dm.MoveToEx 50,50,50,50
        dm.KeyPressChar "space"
        Delay 2000
        Call 图内操作()
    End If
End Function


Function 图内操作()
    frame = 0
    刷图 = 1
    关闭 = 1
    修理 = 1
    
    While 刷图
    dm_ret = dm.CmpColor(19,439,"ec2400-000000",0.8)
    If dm_ret <> 0 Then
        修理 = 0
    End If
        frame = frame + 1
        If frame >= 17000 Then 
            Call releseMove()
            dm.KeyPressChar "esc"
            Call 一秒内随机延迟()
            Call dm随机点击(493,440,5,5,"L")
            刷图 = 0
            Call dm随机点击(505,200,5,5,"L")
            Call 司南界面(0)
        ElseIf frame Mod 120 = 0 Then 
            物品 = 按键找字("稀有")
            人物 = 按键找字("[")
            人物X = 人物(0)
            人物Y = 人物(1)+20
            物品X = 物品(0)
            物品Y = 物品(1)
            接触距离X = 1
            接触距离Y = 1
            人物腰的位置 = 人物Y + 60
            人物脚的位置Y = 人物Y + 100
            // TODO  找怪打怪
            bossPos = dm小地图找图("C:\Users\ChrisWang\Desktop\dnf-img\bossD.bmp")
            heroPos = dm小地图找图("C:\Users\ChrisWang\Desktop\dnf-img\heroD.bmp")
            If heroPos(1) > 0 And  heroPos(1) < 740 And 关闭 > 0 Then 
                relaseSkill("a")
                Delay 2000
                dm.KeyPressChar "S"
                Delay 500
                dm.KeyPressChar "g"
                If 关闭 > 0 Then 
                    Call dm随机点击(755, 130, 5, 5, "L")
                    关闭 = 0
                End If
            End If
            dm_ret = dm.FindStr(0, 0, 800, 600, "存在未拾取", "857658-000000|ddc593-353535", 0.6, intX, intY)
            If intX > 0 Then 
                Call releseMove()
            ElseIf heroPos(1) < 0 And 人物X > 0 Then   // 在Boss房间   And防止过图黑屏导致判断错误
                Call releseMove()
                Delay 2000// 部分boss有行为延迟
                TracePrint 修理
                是否存在司南选择界面 =   司南界面(修理)
                If 是否存在司南选择界面 > 0 Then 
                frame = 0
                    刷图 = 0
                End If
            ElseIf 物品X > 0 Then// 地上存在物品
                TracePrint "捡物品"
                If 人物X < 0 Then 
                    Call 随机左右()
                Else 
                    人物与物品的X距离 = 人物X - 物品X
                    人物与物品的Y距离 = 人物脚的位置Y - 物品Y
                    Call 人物往目标移动(人物与物品的X距离, 人物与物品的Y距离, 接触距离X, 接触距离Y)  
                End If
            Else             // 跑图
                未央之脊 = 按键找字("未央之脊")                
                幻境前殿 = 按键找字("幻境前殿")
                沧池竹林 = 按键找字("沧池竹林")
                残月宫阙 = 按键找字("残月宫阙")
                工会 = 按键找字("无双")
                If 工会(0) < 0 And heroPos(1) < 775 Then // 人物靠地图边缘太近导致找不到人
                    TracePrint "边缘检测"
                    Randomize
                    If Rnd > 0.5 Then 
                        Call move("rightDown")
                    Else 
                        Call move("rightUp")	
                    End If
                Else
                    If 沧池竹林(0) > 0 Then 
                        If heroPos(1) > 730 And heroPos(1) < 750 And heroPos(2) > 60 Then   // 在第二个图往上
                            TracePrint "竹林第二个图"
                            人物与门的X距离 = 人物X - 670
                            人物与门的Y距离 = 人物腰的位置 - 150
                            Call 人物往目标移动(人物与门的X距离, 30, 接触距离X, 接触距离Y) 
                        ElseIf heroPos(1) > 750 And heroPos(2) < 60 Then // 在第4个图往中下
                            TracePrint "竹林第四个图"
                            下一个房间pos = dm.FindStrE(200,350,750,600,"前进","f0f0f0-252525",1.0)
                            下一个房间pos = split(下一个房间pos,"|")
                            门X = int(下一个房间pos(1))
                            TracePrint 人物X
                            TracePrint 门X
                            
                            人物与门的X距离 = 人物X - 门X
                            TracePrint 人物与门的X距离
                            人物与门的Y距离 = 人物腰的位置 - 580
                            Call 人物往目标移动(人物与门的X距离, 人物与门的Y距离, 接触距离X, 接触距离Y) 
                        Else
                            Call 人物保持中线向右移动(人物腰的位置)
                        End If
                    ElseIf 残月宫阙(0) > 0 Then 
                        If heroPos(1) > 730 And heroPos(1) < 750 And heroPos(2) > 60 Then // 在第二个图往上
                            下一个房间pos = dm.FindStrE(150,390,650,600,"前进","f0f0f0-252525",1.0)
                            下一个房间pos = split(下一个房间pos,"|")
                            门X = int(下一个房间pos(1))
                            TracePrint "宫阙第二个图"
                            人物与门的X距离 = 人物X - 门X - 20
                            人物与门的Y距离 = 人物腰的位置 - 150
                            Call 人物往目标移动(人物与门的X距离, 人物与门的Y距离, 接触距离X, 接触距离Y) 
                        ElseIf heroPos(1) > 775 And heroPos(2) < 60 Then // 在第5个图往中下
                            TracePrint "宫阙第5个图"
                            If 人物X < 0 Then 
                                Call 随机左右()
                            Else 
                                menX = 570
                                If 人物X > 350 Or 人物X < 0 Then 
                                    menX = 250
                                End If
                                人物与门的X距离 = 人物X - menX
                                TracePrint 人物与门的X距离
                                人物与门的Y距离 = 人物腰的位置 - 580
                                Call 人物往目标移动(人物与门的X距离, 人物与门的Y距离, 接触距离X, 接触距离Y) 
                            End If
                        Else
                            Call 人物保持中线向右移动(人物腰的位置)
                        End If
       
                    Else 
                        下一个房间pos = dm.FindStrE(350,0,800,600,"前进","f0f0f0-252525",1.0)
                        下一个房间pos = split(下一个房间pos,"|")
                        门X = int(下一个房间pos(1))+40
                        门Y = int(下一个房间pos(2))
                        If 门Y < 400 Then 
                            门Y = 门Y - 50
                        Else 
                            门Y = 门Y + 50
                        End If
                        // 有前进字体  
                        If 门X > 350 Then 
                            人物与门的X距离 = 人物X - 门X 
                            人物与门的Y距离 = 人物腰的位置 - 门Y 
                            Call 人物往目标移动(人物与门的X距离, 人物与门的Y距离, 接触距离X, 接触距离Y)
                        Else    // 前殿与未央之脊
                            Call 人物保持中线向右移动(人物腰的位置)
                        End If
                    End If
                End If
            End If
        End If
    Wend
End Function
Call 图内操作()