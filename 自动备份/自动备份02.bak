[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=c3a8e001-9d67-410d-a061-45655e6a2584
Description=�ٻ�δ��
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=2
QUI=
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
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


[Script]
 
Call ��Įע��()
Function ��Įע��()
    need_ver = "3.1233"
    Set ws = createobject("Wscript.Shell")
    ws.run "regsvr32 atl.dll /s"
    Set ws = nothing
    PutAttachment "C:\Users\Administrator\Desktop\��Į���3.1233", "*.*"
    PutAttachment ".\Plugin", "RegDll.dll"
    Call Plugin.RegDll.Reg("C:\Users\Administrator\Desktop\��Į���3.1233\dm.dll")
    Set dm = createobject("dm.dmsoft")
    ver = dm.Ver()
    If ver <> need_ver Then
        Set dm = nothing
        Set ws = createobject("Wscript.Shell")
        ws.run "regsvr32 C:\Users\Administrator\Desktop\��Į���3.1233\dm.dll /s"
        Set ws = nothing
        Delay 1200
        Set dm = createobject("dm.dmsoft")
        ver = dm.Ver()
        If ver <> need_ver Then
            MessageBox "����汾����,��ǰʹ�õİ汾��:" & ver & ",�������Ŀ¼��:" & dm.GetBasePath()
            MessageBox "��رճ���,���´򿪱������ٳ���"
            EndScript
        End If
    Else
        TracePrint ver
        TracePrint "ע��ɹ���"
    End If
End Function
//Sub OnScriptExit()
//    dm_ret = dm.UnBindWindow() 
//End Sub
Function һ��������ӳ�()
    Randomize
    Delay Rnd*500+500
End Function
Function �߰ٺ���������ӳ�()
    Randomize
    Delay Rnd*500+200
End Function
Function dm������(x, y, w,h,way)
    dm.MoveToEx x,y,w,h
    Call �߰ٺ���������ӳ�()
    If way = "L" Then
        dm.LeftClick
    Else
        dm.RightClick 
    End If
    Call �߰ٺ���������ӳ�()
End Function
Function dm�ҵ���ͼ(picPath)
    pos = dm.FindPicE(0,0,800,600,picPath,"000000",0.5,0)
    pos = split(pos,"|")
    If int(pos(1)) > 0 Then 
        x = pos(1)
        y = pos(2)
        //        TracePrint  picPath + "λ�ã� x:"+x+"y:"+y
    End If
    dm�ҵ���ͼ = pos
End Function
Function dmС��ͼ��ͼ(picPath)
    pos = dm.FindPicE(680,20,795,100,picPath,"000000",0.5,0)
    pos = split(pos,"|")
    If int(pos(1)) > 0 Then 
        x = pos(1)
        y = pos(2)
        //        TracePrint  picPath + "λ�ã� x:"+x+"y:"+y
    End If
    dmС��ͼ��ͼ = pos
End Function
Function ��������(word)
    iCoord = Plugin.Pic.FindWordShape(0, 0, 800, 600, word, "����", 9, 0, 0.5)
    XY = Split(iCoord, "|")
    If XY(0) >= 0 Then
        TracePrint  word+"λ��x"+XY(0) +"y:"+XY(1)
    End If
    �������� = XY
End Function
dm_soft  = dm.SetDict(0,"C:\Users\Administrator\Desktop\��Į���3.1233\dm_soft.txt")
st9 = dm.SetDict(1,"C:\Users\Administrator\Desktop\��Į���3.1233\����9��.txt")
ywsz9 = dm.SetDict(2,"C:\Users\Administrator\Desktop\��Į���3.1233\Ӣ��+����.txt")
hwnd = dm.FindWindow("���³�����ʿ", "���³�����ʿ")
dm_ret = dm.BindWindow(hwnd, "normal", "normal", "dx", 0)
dm.MoveWindow hwnd, 0, 0
dm_ret = dm.SetWindowState(hwnd,1) // ����
// ��������End
Function move(action)
    If action = "up" Then 
        dm.KeyUpChar "left"
        dm.KeyUpChar "right"
        dm.KeyUpChar "down"
        dm.KeyDownChar "up"
    ElseIf action = "down" Then
        dm.KeyUpChar "left"
        dm.KeyUpChar "right"
        dm.KeyUpChar "up"
        dm.KeyDownChar "down"
    ElseIf action = "left" Then
        dm.KeyUpChar "up"
        dm.KeyUpChar "down"
        dm.KeyUpChar "right"
        dm.KeyDownChar "left"
    ElseIf action = "right" Then
        dm.KeyUpChar "up"
        dm.KeyUpChar "down"
        dm.KeyUpChar "left"
        dm.KeyDownChar "right"
    ElseIf action = "leftUp" Then
        dm.KeyUpChar "down"
        dm.KeyUpChar "right"
        dm.KeyDownChar "left"
        dm.KeyDownChar "up"
    ElseIf action = "leftDown" Then
        dm.KeyUpChar "right"
        dm.KeyUpChar "up"
        dm.KeyDownChar "left"
        dm.KeyDownChar "down"
    ElseIf action = "rightUp" Then
        dm.KeyUpChar "left"
        dm.KeyUpChar "down"
        dm.KeyDownChar "right"
        Delay 500
        dm.KeyDownChar "up"
    ElseIf action = "rightDown" Then
        dm.KeyUpChar "left"
        dm.KeyUpChar "up"
        dm.KeyDownChar "right"
        Delay 500
        dm.KeyDownChar "down"
    End If
End Function
Function releseMove()
    dm.KeyUpChar "left"
    dm.KeyUpChar "right"
    dm.KeyUpChar "up"
    dm.KeyUpChar "down"
End Function
Function ������Ŀ���ƶ�(������Ŀ��X����,������Ŀ��Y����,��������X,��������Y)
    If Abs(������Ŀ��X����) > ��������X And Abs(������Ŀ��Y����) > ��������Y  Then 
        If ������Ŀ��X���� > 0 And  ������Ŀ��Y���� > 0  Then 
            Call move("leftUp")
        ElseIf  ������Ŀ��X���� > 0 And  ������Ŀ��Y���� < 0 
            Call move("leftDown")
        ElseIf  ������Ŀ��X���� < 0 And  ������Ŀ��Y���� > 0 
            Call move("rightUp")
        ElseIf  ������Ŀ��X���� < 0 And  ������Ŀ��Y���� < 0 
            Call move("rightDown")
        End If
    ElseIf Abs(������Ŀ��X����) < ��������X And Abs(������Ŀ��Y����) > ��������Y Then 
        If ������Ŀ��Y���� > 0 Then 
            Call move("up")
        Else 
            Call move("down")
        End If
    ElseIf Abs(������Ŀ��X����) > ��������X And Abs(������Ŀ��Y����) < ��������Y Then 
        If ������Ŀ��X���� > 0 Then 
            Call move("left")
        Else 
            Call move("right")
        End If   
    End If
End Function
Function ���ﱣ�����������ƶ�(��������λ��)
    TracePrint "��������λ��" + CStr(��������λ��)
    If ��������λ�� > 380 Then // ��Ļ����
        Call move("rightUp")
    Else 
        Call move("rightDown")    
    End If
End Function
Function releaseKeyChar(keyChar)
    dm.KeyPressChar keyChar
    Call һ��������ӳ�()
End Function
Function �������()
    Randomize
    If Rnd > 0.5 Then 
        Call move("right")
    Else 
        Call move("left")	
    End If
End Function
Function ����
    Call releaseKeyChar("~")
    Call releaseKeyChar("x")
    Call releaseKeyChar("x")
    Call releaseKeyChar("x")
End Function
Function ˾�Ͻ���(����)
    drsn = dm�ҵ���ͼ("C:\Users\Administrator\Desktop\dnf-img\1drsn.bmp|C:\Users\Administrator\Desktop\dnf-img\2drsn.bmp|C:\Users\Administrator\Desktop\dnf-img\3drsn.bmp|C:\Users\Administrator\Desktop\dnf-img\4drsn.bmp|C:\Users\Administrator\Desktop\dnf-img\5drsn.bmp")
    ˾�Ͻ��� = int(drsn(1))
    // �ҵ�����˾��
    If ˾�Ͻ��� > 0 Then
        Call ����()
//        If ���� > 0 Then 
//            Call releaseKeyChar("s")
//            Call releaseKeyChar("space")
//        End If
        Call dm������(drsn(1),drsn(2),5,5,"R")
        Call dm������(160, 545, 10, 10, "L")// ������ť
        dm.MoveToEx 50,50,50,50
        Call releaseKeyChar("space")
        Call ͼ�ڲ���()
//    Else 
//        �볡 = ��������("δ��þ��볡")
//        If �볡(0) > 0 Then 
//            Call ����()
//           Call ƣ�Ͳ��㴦����ȥ��һ��()
//        End If
    End If
End Function



��ɫN = 0

Function ѡ������(N)
    �ڼ��� = N-1
    Call dm������(�ڼ��� * 130, 335, 50, 50, "L") // ѡ����
    Call releaseKeyChar("space")
    Delay 13000
    Call move("down")
    Delay 3000
    frameS = 1
    ѡ�� = 1
    While ѡ��
        frameS  = frameS +1
        If frameS Mod 50 = 0 Then
            ����ģʽ = ��������("����ģʽ")
            ������ = ��������("������")
            If ����ģʽ(0) > 0 or ������(0) > 0 Then 
                Call move("down")
            Else 
                TracePrint "���ƿ�"
                ���� = ��������("��")
                If ����(0) > 0 Then 
                    ѡ�� = 0
                    Call releseMove()
                    Call dm������(505, 200, 5, 5, "L")
                    dm.MoveToEx 50,50,50,50 // ��ֹ�ڵ�
                    Call ˾�Ͻ���(0)
                Else 
                    Call move("rightDown")
                End If
            End If
        End If 
    Wend
End Function
// Call ѡ������(1)
Function ƣ�Ͳ��㴦����ȥ��һ��()
    Call releaseKeyChar("f3")
    // �����ֽ��
    Call dm������(460, 330, 5, 5, "L")
    Delay 500
    dm.LeftClick 
    Delay 500
    // ȷ�Ϻ������ֽ��
    Call dm������(390, 330, 2, 2, "L")
    Call dm������(390, 330, 2, 2, "L")
    // ����װ��
    Call releaseKeyChar("a")
    Call releaseKeyChar("space")
    Delay 2000
    // ��������
    Call ѭ��ɾ������(490,395)   // ǰ20��
    Call ѭ��ɾ������(490, 455)// ��20��
    // �رշֽ����ȥѡ������
    Call releaseKeyChar("esc")  
    Call releaseKeyChar("esc")
    Call dm������(365, 440, 5, 5, "L")// ���ѡ�����ﰴť
    Delay 3000
    // Ŀǰ�̶�2�� �����·� 1 2λ��
    Call ѡ������(2)
End Function
//Call ƣ�Ͳ��㴦����ȥ��һ��()
Function ͼ�ڲ���()
    frame = 0
    ˢͼ = 1
    �رչؿ���ʾ = 1
    ���� = 1  // һ������ʵ��ֻ����һ��
    While ˢͼ
        frame = frame + 1
        If frame >= 6000 Then   // 1��30��
            ˢͼ = 0
            Call releseMove()
            Call releaseKeyChar("esc")
            Call dm������(493, 440, 5, 5, "L")
            Delay 2000
//            ���� = ��������("����")
//                If ����(0) > 0 Then 
//              
//                End If
              Call dm������(500, 245, 5, 5, "L")
                Call dm������(530,315, 5, 5, "L")
            dm.MoveToEx 50,50,50,50 // ��ֹ�ڵ�
            Call ˾�Ͻ���(0)
        ElseIf frame Mod 60 = 0 Then
            �޷��볡 = ��������("ƣ��ֵ") 
            If �޷��볡(0) > 0 Then
                TracePrint "ƣ�Ͳ���"
                ˢͼ = 0
                Call releseMove()
                Call releaseKeyChar("esc") // �ر�ƣ�Ͳ�����ʾ���� 
                Call ƣ�Ͳ��㴦����ȥ��һ��()
            End If
            ��Ʒ = ��������("ϡ��")
            ���� = ��������("[")
            ����X = ����(0)
            ����Y = ����(1)+20
            ��ƷX = ��Ʒ(0)
            ��ƷY = ��Ʒ(1)
            �Ӵ�����X = 1
            �Ӵ�����Y = 1
            ��������λ�� = ����Y + 60
            ����ŵ�λ��Y = ����Y + 100
            bossPos = dmС��ͼ��ͼ("C:\Users\Administrator\Desktop\dnf-img\bossD.bmp")
            heroPos = dmС��ͼ��ͼ("C:\Users\Administrator\Desktop\dnf-img\heroD.bmp")
            If heroPos(1) > 0 And  heroPos(1) < 740 And �رչؿ���ʾ > 0 Then 
                Call releaseKeyChar("a")
                Delay 2000
                Call releaseKeyChar("g")
                Call dm������(755, 130, 5, 5, "L")
                �رչؿ���ʾ = 0
            End If
            dm_ret = dm.FindStr(0, 0, 800, 600, "����δʰȡ", "857658-000000|ddc593-353535", 0.8, intX, intY)
            If intX > 0 Then 
                Call releseMove()
            ElseIf heroPos(1) < 0 And ����X > 0 Then   // ��Boss����And��ֹ��ͼ���������жϴ���
                Call releseMove()
                Delay 3000
                ˾�Ͻ���(����)
                If �Ƿ����˾��ѡ����� > 0 Then 
                    frame = 0
                    ˢͼ = 0
                    ���� = 0
                    TracePrint "����" +CStr(����)
                End If
            ElseIf ��ƷX > 0 Then// ���ϴ�����Ʒ
                TracePrint "����Ʒ"
                If ����X < 0 Then 
                    Call �������()
                Else 
                    ��������Ʒ��X���� = ����X - ��ƷX
                    ��������Ʒ��Y���� = ����ŵ�λ��Y - ��ƷY
                    Call ������Ŀ���ƶ�(��������Ʒ��X����, ��������Ʒ��Y����, �Ӵ�����X, �Ӵ�����Y)  
                End If
            Else         
                δ��֮�� = ��������("δ��֮��")                
                �þ�ǰ�� = ��������("�þ�ǰ��")
                �׳����� = ��������("�׳�����")
                ���¹��� = ��������("���¹���")
                ���� = ��������("��˫")
                If ����(0) > 0 Then 
                    ����X = ����(0) - 20
                End If
                If   ����(0) < 0 And heroPos(1) < 775  Then // ���￿��ͼ��Ե̫�������Ҳ�����
                    TracePrint "��Ե���"
                    Call move("left")
                    Delay 300
                    Randomize
                    //  ���ⳡ��
                    
                    If ���¹���(0) > 0 And ����X > 500  Then  //   �����·�ͼ���ұ�
                        Call move("leftDown")
                    ElseIf �þ�ǰ��(0) > 0 And heroPos(2) > 80   Then  // �þ��·�ͼ
                        Call move("leftDown")
                    ElseIf Rnd > 0.5 Then 
                        Call move("rightDown")
                    Else 
                        Call move("rightUp")	
                    End If
                Else
                    If �׳�����(0) > 0 Then 
                        If heroPos(1) > 730 And heroPos(1) < 750 And heroPos(2) > 60 Then   // �ڵڶ���ͼ����
                            TracePrint "���ֵڶ���ͼ"
                            �������ŵ�X���� = ����X - 670
                            �������ŵ�Y���� = ��������λ�� - 150
                            Call ������Ŀ���ƶ�(�������ŵ�X����, 30, �Ӵ�����X, �Ӵ�����Y) 
                        ElseIf heroPos(1) > 750 And heroPos(2) < 60 Then // �ڵ�4��ͼ������
                            TracePrint "���ֵ��ĸ�ͼ"
                            ��һ������pos = dm.FindStrE(200,350,750,600,"ǰ��","f0f0f0-252525",1.0)
                            ��һ������pos = split(��һ������pos,"|")
                            ��X = int(��һ������pos(1))
                            If ��X > 0 Then 
                                �������ŵ�X���� = ����X - ��X
                                �������ŵ�Y���� = ��������λ�� - 580
                                Call ������Ŀ���ƶ�(�������ŵ�X����, �������ŵ�Y����, �Ӵ�����X, �Ӵ�����Y)
                            Else 
                                Call ������Ŀ���ƶ�(-5, -5, �Ӵ�����X, �Ӵ�����Y)
                            End If
                        ElseIf  heroPos(1) > 750 And heroPos(2) > 80 Then // �ڵ�5��ͼ
                            Call ǰ��And�����ƶ�(��������λ��)
                        Else
                            Call ���ﱣ�����������ƶ�(��������λ��)
                        End If
                    ElseIf ���¹���(0) > 0 Then 
                        If heroPos(1) < 740  Then
                            Call ǰ��And�����ƶ�(��������λ��)
                        ElseIf heroPos(1) > 740 And heroPos(1) < 750 And heroPos(2) > 60 Then// �ڵڶ������·�ͼ����
                            TracePrint "���ڵڶ���ͼ"
                            If ����X > 650 Then 
                                Call move("left")
                            Else 
                                ��һ������pos = dm.FindStrE(150,390,650,600,"ǰ��","f0f0f0-252525",1.0)
                                ��һ������pos = split(��һ������pos,"|")
                                ��X = int(��һ������pos(1))
                                �������ŵ�X���� = ����X - ��X - 20
                                �������ŵ�Y���� = ��������λ�� - 150
                                Call move("down")
                                Delay 100
                                Call ������Ŀ���ƶ�(�������ŵ�X����, �������ŵ�Y����, �Ӵ�����X, �Ӵ�����Y) 
                            End If
                        ElseIf heroPos(1) > 755 And  heroPos(2) > 65 Then //  ���ҷ���ͼ
                            If ����X < 0 Then 
                                Call �������()
                            Else 
                                Call move("left")
                            End If
                        ElseIf heroPos(1) > 775 And heroPos(2) < 60 Then // �ڵ�5��ͼ������
                            TracePrint "���ڵ�5��ͼ"
                            If ����X < 0 Then 
                                Call �������()
                            Else 
                                menX = 570
                                If ����X > 350 Or ����X < 0 Then 
                                    menX = 250
                                End If
                                �������ŵ�X���� = ����X - menX
                                �������ŵ�Y���� = ��������λ�� - 580
                                Call ������Ŀ���ƶ�(�������ŵ�X����, �������ŵ�Y����, �Ӵ�����X, �Ӵ�����Y) 
                            End If
                        Else               
                            Call ���ﱣ�����������ƶ�(��������λ��)
                        End If
                    ElseIf �þ�ǰ��(0)  > 0 Then
                        If heroPos(2) < 60 or heroPos(2) > 80 Then // ǰ�����Ϸ����·�
                            Call ǰ��And�����ƶ�(��������λ��)
                        Else
                            Call move("right")
                        End If
                    ElseIf  δ��֮��(0) > 0 Then
                        If  heroPos(2) < 65   Then // �ڵ�4��ͼ����ǰ�����м���
                            Call ǰ��And�����ƶ�(��������λ��)
                        Else 
                            Call ���ﱣ�����������ƶ�(��������λ��)
                   
                        End If
                    Else 
                        Call ǰ��And�����ƶ�(��������λ��)
                    End If
                End If
            End If
        End If
    Wend
End Function
Function ǰ��And�����ƶ�(��������λ��)
    ��һ������pos = dm.FindStrE(350,0,800,600,"ǰ��","f0f0f0-252525",1.0)
    ��һ������pos = split(��һ������pos,"|")
    ��X = int(��һ������pos(1))
    ��Y = int(��һ������pos(2))
    If ��Y < 400 Then   // ǰ��������������
        ��Y = ��Y - 600  
    Else 
        ��Y = ��Y + 600
    End If
    If ��X > 350 Then 
        �������ŵ�X���� = ����X - ��X 
        �������ŵ�Y���� = ��������λ�� - ��Y
        Call ������Ŀ���ƶ�(�������ŵ�X����, �������ŵ�Y����, �Ӵ�����X, �Ӵ�����Y)
    Else   
        Call ���ﱣ�����������ƶ�(��������λ��)
    End If
End Function
Function ѭ��ɾ������(sx, sy)
    Const eachEdge = 30
    For i = 0 to 9
        For j = 0 to 1
            X = sx+eachEdge * i
            Y = sy+eachEdge*j
            Call dm������(X, Y,4,4,"L")
        Next
    Next
    Call releaseKeyChar("space")
    Delay 2000
End Function


//Call ƣ�Ͳ��㴦����ȥ��һ��()
//Call ѡ������(��ɫN + 2)
Call ͼ�ڲ���()